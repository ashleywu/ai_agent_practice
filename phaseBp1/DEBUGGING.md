# 调试 500 错误指南

## 问题分析

你遇到的 500 错误来自 API 服务器，不是代理服务器。这意味着：
- ✅ 网络连接正常
- ✅ API 密钥已发送
- ✅ 请求格式基本正确
- ❌ API 服务器处理请求时出错

## 调试步骤

### 1. 重启代理服务器并查看详细日志

```bash
python server.py
```

默认会在 8080 端口启动。

### 2. 在浏览器中测试

1. 打开 `http://localhost:8080`
2. 点击 "Capture Aha!" 按钮
3. **立即查看终端输出** - 会显示详细的错误信息

### 3. 查看终端中的错误信息

代理服务器现在会打印：
- API 请求的详细信息
- API 返回的错误响应（完整的错误消息）
- Python traceback（如果有代理服务器错误）

## 可能的原因

根据 OpenAPI 规范，转录 API 支持：
- MP3, WAV, FLAC, M4A 等格式
- **WebM 格式可能不被支持**

### 已做的改进

1. ✅ 优先尝试使用 M4A/AAC 格式（更兼容）
2. ✅ 改进错误日志记录
3. ✅ 显示 API 返回的详细错误消息

## 下一步

1. **重启代理服务器**
2. **测试并查看终端输出**
3. **将终端中的错误信息发给我**，特别是：
   - `API Error 500:` 后面的内容
   - 任何 Python traceback

## 如果还是 500 错误

可能的原因：
1. **音频格式不支持** - WebM 可能不被 API 接受
2. **文件太大** - 30秒音频可能超过限制
3. **API 服务器问题** - 后端可能有 bug
4. **API 密钥权限** - 可能没有转录权限

查看终端输出中的 `API Error 500:` 消息，这会告诉我们具体是什么问题。
